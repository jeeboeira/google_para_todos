% !TeX program = lualatex
% !TeX root = main.tex
% !TeX encoding = UTF-8

\documentclass[12pt,a4paper,oneside]{report}

% ------------------------------------------------------------
% IDIOMA, METADADOS (defina antes do hypersetup)
% ------------------------------------------------------------
\usepackage[brazil]{babel}

% ---- Metadados da apostila (defina antes do hypersetup)
\newcommand{\titulo}{Google para Todos}
\newcommand{\autor}{Turma Extensão III — ADS/IFRS — Campus: Farroupilha (2025/2)}
\newcommand{\versao}{v1.0}
\newcommand{\data}{2025/2}

% ------------------------------------------------------------
% TIPOGRAFIA & FONTE
% ------------------------------------------------------------
\usepackage{fontspec} % exige XeLaTeX ou LuaLaTeX
\defaultfontfeatures{Ligatures=TeX, Scale=MatchLowercase}
\setmainfont{Poppins}[
Path=fonts/Poppins/,
Extension=.ttf,
UprightFont=*-Regular,
BoldFont=*-Bold,
ItalicFont=*-Italic,
BoldItalicFont=*-BoldItalic
]

% fallback para alguns glyphs
\usepackage{newunicodechar}
\newunicodechar{→}{\ensuremath{\rightarrow}}
\usepackage{menukeys}


% ------------------------------------------------------------
% LAYOUT E FIGURAS
% ------------------------------------------------------------
\usepackage[a4paper,margin=2.2cm]{geometry}
\usepackage{graphicx}
\graphicspath{{images/}}
\usepackage{float}
\usepackage{booktabs}
\usepackage{array}

% ------------------------------------------------------------
% CORES
% ------------------------------------------------------------
\usepackage{xcolor}
\definecolor{dicas}{HTML}{4285F4}
\definecolor{alerta}{HTML}{DB4437}
\definecolor{conhecimentoExtra}{HTML}{F4B400}
\definecolor{formulas}{HTML}{0F9D58}
\definecolor{primary}{HTML}{020202}
\definecolor{ggray}{HTML}{5F6368}
\definecolor{ggreen}{HTML}{0F9D58}
\definecolor{gyellow}{HTML}{F4B400}
\definecolor{gred}{HTML}{DB4437}

% cores por capítulo
\definecolor{catIntroducao}{HTML}{2E86C1}      % Azul
\definecolor{catBusca}{HTML}{28B463}           % Verde
\definecolor{catDrive}{HTML}{F4C20D}           % Amarelo Google
\definecolor{catFormularios}{HTML}{884EA0}     % Roxo
\definecolor{catGmail}{HTML}{DB4437}           % Vermelho
\definecolor{catAgenda}{HTML}{00ACC1}          % Ciano
\definecolor{catDocs}{HTML}{1A73E8}            % Azul Google Docs
\definecolor{catPlanilhas}{HTML}{0F9D58}       % Verde Sheets
\definecolor{catSlides}{HTML}{F4B400}          % Laranja Google Slides
\definecolor{catBibliografia}{HTML}{5F6368}    % Cinza neutro

% ------------------------------------------------------------
% LISTAS, CITAÇÕES, UNIDADES
% ------------------------------------------------------------
\usepackage{enumitem}
\setlist{itemsep=8pt, topsep=6pt}
\usepackage{csquotes}
\usepackage{siunitx}
\sisetup{
	space-before-unit = false,
	number-unit-product = {}
}

% ------------------------------------------------------------
% LINKS, BIBLATEX E HYPERREF
% ------------------------------------------------------------
\usepackage{hyperref}
\usepackage[
automake
, nomain
% , nonumberlist
]{glossaries-extra}
\input{sections/extras/definicao_glossario.tex}
\renewcommand*{\glossarysection}[2][]{%
	\section*{#2}%
	\addcontentsline{toc}{section}{#2}%
}

\usepackage{indentfirst}
\usepackage[backend=biber,style=authoryear]{biblatex}
\addbibresource{sections/motor_de_busca/Motor de Busca.bib}
\addbibresource{sections/google_drive/google_drive.bib}

\newif\ifprint
\printfalse % tela por padrão
% \printtrue % descomente para modo impressão

\ifprint
\hypersetup{
	hidelinks,
	pdfauthor=\autor,
	pdftitle=\titulo,
	pdfstartview=FitH
}
\else
\hypersetup{
	colorlinks=true,
	allcolors=primary,
	linktoc=all,
	breaklinks=true,
	pdfauthor=\autor,
	pdftitle=\titulo,
	pdfpagemode=UseOutlines
}
\fi

% ------------------------------------------------------------
% MACROS ÚTEIS
% ------------------------------------------------------------
\newcommand{\tecla}[1]{\fbox{#1}}
\newcommand{\produto}[1]{\textbf{#1}}

\newcommand{\codeblock}[1]{%
	\vspace{1em}%
	\begin{tcolorbox}[colback=gray!5,colframe=gray!40,boxrule=0.4pt,arc=8pt,enhanced jigsaw]
		\begin{center}\texttt{#1}\end{center}
	\end{tcolorbox}
	\vspace{1em}%
}

\newcommand{\hseparator}{
	\vspace{1em}
	\noindent\textcolor{gray}{\rule{\linewidth}{1pt}}
	\vspace{1em}
}

% ------------------------------------------------------------
% TIKZ, GADGETS VISUAIS E BACKGROUND
% ------------------------------------------------------------
\usepackage{tikz}
\usetikzlibrary{calc,shapes,positioning}
\newdimen\trianglesize
\trianglesize=2cm

% ------------------------------------------------------------
% TITULOS E FORMATAÇÃO
% ------------------------------------------------------------
\usepackage{setspace}
\onehalfspacing

% Numerar até o nível \paragraph
\setcounter{secnumdepth}{3} % numera até \paragraph
\setcounter{tocdepth}{2} 	% aparece no sumário

\usepackage{titlesec}
\titlespacing*{\chapter}{0pt}{-1ex}{2ex}
\titlespacing*{\section}{0pt}{14pt}{8pt}
\titlespacing*{\subsection}{0pt}{12pt}{6pt}
\titlespacing*{\paragraph}{0pt}{6pt}{2pt}

\titleformat{\section}{\Large\bfseries\color{primary}}{\thesection}{0.6em}{}
\titleformat{\subsection}{\large\bfseries\color{ggray}}{\thesubsection}{0.6em}{}
\titleformat{\subsubsection}{\bfseries}{\thesubsubsection}{0.6em}{}
\titleformat{\paragraph}{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}[]


% rotina de seleção de cor do capítulo (corrigida e simples)
\newcommand{\setchaptercolor}{%
	\ifcase\value{chapter}%
	\colorlet{chaptercolor}{catIntroducao}
	\or
	\colorlet{chaptercolor}{catIntroducao}
	\or
	\colorlet{chaptercolor}{catBusca}
	\or
	\colorlet{chaptercolor}{catDrive}
	\or
	\colorlet{chaptercolor}{catFormularios}
	\or
	\colorlet{chaptercolor}{catGmail}
	\or
	\colorlet{chaptercolor}{catAgenda}
	\or
	\colorlet{chaptercolor}{catDocs}
	\or
	\colorlet{chaptercolor}{catPlanilhas}
	\or
	\colorlet{chaptercolor}{catSlides}
	\else
	\colorlet{chaptercolor}{catBibliografia}
	\fi
}

% estilo do título de capítulo com faixa + caixa
\newcommand{\ChapterTitleFormat}[1]{%
	\setchaptercolor%
	\ifnum\value{chapter}>0
	% capa colorida na parte superior
	\begin{tikzpicture}[remember picture,overlay]
		\fill[chaptercolor!90!black] 
		(current page.north west) rectangle ([yshift=-1.5cm]current page.north east);
	\end{tikzpicture}
	\vspace*{-2.7cm}
	\tcbox[
	colback=white,
	colframe=chaptercolor!90!black,
	boxrule=0.8pt,
	arc=8pt,
	left=8pt,right=8pt,top=6pt,bottom=3pt,
	boxsep=0pt,
	enhanced,
	]{%
		{\huge\textcolor{chaptercolor!90!black}{\bfseries \thechapter. #1}}%
	}
	\vspace{-1.2cm}
	\else
	% sem número (ex.: prefácio)
	\begin{tikzpicture}[remember picture,overlay]
		\fill[chaptercolor!90!black] 
		(current page.north west) rectangle ([yshift=-1.5cm]current page.north east);
	\end{tikzpicture}
	\vspace*{-2.6cm}
	\tcbox[
	colback=white,
	colframe=chaptercolor!90!black,
	boxrule=0.8pt,
	arc=8pt,
	left=8pt,right=8pt,top=6pt,bottom=3pt,
	boxsep=0pt,
	enhanced,
	]{%
		{\huge\textcolor{chaptercolor!90!black}{\bfseries #1}}%
	}
	\vspace{-1.2cm}
	\fi
}

\titleformat{\chapter}[block]{\large\bfseries\color{black}}{}{0pt}{\ChapterTitleFormat}

% Add background triangles per página (shipout hook)
\AddToHook{shipout/background}{%
	\ifnum\value{chapter}>0
	\setchaptercolor
	\begin{tikzpicture}[remember picture,overlay]
		\ifodd\value{page}
		% triângulo direito
		\fill[chaptercolor] 
		([xshift=0pt,yshift=-0.6\trianglesize]current page.north east) -- 
		([xshift=-0.6\trianglesize,yshift=0pt]current page.north east) -- 
		([xshift= 0.8\trianglesize,yshift= 0.8\trianglesize]current page.north east) --
		cycle;
		\draw[line width=0.12\trianglesize, chaptercolor]
		([xshift=0cm]current page.north east) -- ([xshift=0cm]current page.south east);
		\else
		% triângulo esquerdo
		\fill[chaptercolor]
		([xshift=0pt,yshift=-0.6\trianglesize]current page.north west) --
		([xshift=0.6\trianglesize,yshift=0pt]current page.north west) --
		([xshift=-0.8\trianglesize,yshift= 0.8\trianglesize]current page.north west) --
		cycle;
		\draw[line width=0.12\trianglesize, chaptercolor]
		([xshift=0cm]current page.north west) -- ([xshift=0cm]current page.south west);
		\fi
	\end{tikzpicture}
	\fi
}

% ------------------------------------------------------------
% CAIXAS VISUAIS
% ------------------------------------------------------------
\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable}
\newtcolorbox{objetivos}[1][]{
	breakable, colback=primary!5, colframe=primary, title=Objetivos, fonttitle=\bfseries, #1}
\newtcolorbox{passos}[1][]{
	breakable, colback=ggreen!5, colframe=formulas, title=Passo a passo, fonttitle=\bfseries, #1}
\newtcolorbox{dica}[1][]{
	breakable, colback=gyellow!10, colframe=conhecimentoExtra, title=Dica, fonttitle=\bfseries, #1}
\newtcolorbox{atencao}[1][]{
	breakable, colback=gred!5, colframe=alerta, title=Atenção, fonttitle=\bfseries, #1}
\newtcolorbox{checagem}[1][]{
	breakable, colback=white, colframe=dicas, title=Checklist de domínio, fonttitle=\bfseries, #1}

% código (listings)
\usepackage{listings}
\lstset{
	basicstyle=\ttfamily\small,
	breaklines=true,
	frame=none,
	showstringspaces=false
}

% se preferir minted (requere -shell-escape), comente listings e ative minted
% \usepackage{minted}

% ------------------------------------------------------------
% RODAPÉS / HEADERS
% ------------------------------------------------------------
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small\textit{\titulo}}
\fancyhead[R]{\small\textit{\leftmark}}
\fancyfoot[C]{\small\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}
\setlength{\headheight}{13.6pt}

% ------------------------------------------------------------
% OUTRAS CONFIGS E AJUSTES
% ------------------------------------------------------------
\usepackage{csquotes} % já carregado acima (seguro repetir)
\hbadness=10000 % suprime underfull warnings

% microtypography (melhora justificação) deve ficar no fim do \gls{arquivo}
%\usepackage{microtype}

% ------------------------------------------------------------
% INÍCIO DO DOCUMENTO
% ------------------------------------------------------------
\begin{document}
	
	\input{frontmatter/capa.tex}
	
	% pré-texto em romanos
	\pagenumbering{roman}
	\tableofcontents
	\clearpage
	
	% corpo em arábicos
	\pagenumbering{arabic}

%\input{sections/exemplo/exemplo.tex}

\chapter{Introdução}
\input{sections/introducao/introducao}
%
\chapter{Motor de Busca}
\input{sections/motor_de_busca/introducao.tex}
\input{sections/motor_de_busca/visao_geral.tex}
\input{sections/motor_de_busca/operadores.tex}
\input{sections/motor_de_busca/ideias_de_uso.tex}
\input{sections/motor_de_busca/boas_praticas.tex}
%
\chapter{Google Drive}
\input{sections/google_drive/introducao.tex}
\input{sections/google_drive/compartilhamento_e_permissoes.tex}
\input{sections/google_drive/desktop.tex}
\input{sections/google_drive/sincronizacao_e_backup.tex}
\input{sections/google_drive/integracao_ferramentas.tex}
\input{sections/google_drive/colaboracao.tex}
%
\chapter{Formulários}
\input{sections/forms/introducao_ao_google_forms.tex}
\input{sections/forms/acesso_a_ferramenta.tex}
\input{sections/forms/interface_do_google_forms.tex}
\input{sections/forms/criacao_de_formularios.tex}
\input{sections/forms/tipos_de_perguntas_disponiveis.tex}
\input{sections/forms/personalizacao_do_formulario.tex}
\input{sections/forms/configuracoes_do_formulario.tex}
\input{sections/forms/logica_e_condicional.tex}
\input{sections/forms/compartilhamento_do_formulario.tex}
\input{sections/forms/coleta_e_analise_de_respostas.tex}
\input{sections/forms/dicas_e_boas_praticas.tex}
%
\chapter{Gmail}
\input{sections/gmail/introducao_gmail.tex}
\input{sections/gmail/categorias_marcadores_filtros.tex}
\input{sections/gmail/configuracoes_avancadas.tex}
\input{sections/gmail/dicas_e_boas_praticas.tex}
\input{sections/gmail/escrever_enviar_download_anexos_emails_com_estrela.tex}
\input{sections/gmail/exclusao_reg_leitura_adiar.tex}
\input{sections/gmail/responder_encaminhar_marcar_emails.tex}
%
\chapter{Agenda}
\input{sections/agenda/introducao_google_agenda.tex}
\input{sections/agenda/configuracoes.tex}
\input{sections/agenda/dicas_e_boas_praticas.tex}
\input{sections/agenda/gerenciamento_de_multiplas_agendas.tex}
\input{sections/agenda/gerenciamento_entradas_no_calendario.tex}
%
\chapter{Documentos Google}
\input{sections/documentos/introducao_documentos.tex}
\input{sections/documentos/menu_inserir}
\input{sections/documentos/menu_ferramentas.tex}
\input{sections/documentos/trabalhando_com_estilos.tex}
\input{sections/documentos/ativar_desativar_correcao_automatica.tex}
\input{sections/documentos/contagem_de_palavras.tex}
\input{sections/documentos/historico_de_versoes.tex}
\input{sections/documentos/edicao_colaborativa.tex}
\input{sections/documentos/download_imprimir.tex}
\input{sections/documentos/comandos_e_atalhos.tex}
\input{sections/documentos/status_do_documento_e_uso_offline.tex}
\input{sections/documentos/guias_de_documentos.tex}
\input{sections/documentos/extensoes.tex}
\input{sections/documentos/cabecalho_e_rodape.tex}
\input{sections/documentos/documentos}
\input{sections/documentos/exemplo_pratico_confeccao_curriculo.tex}
%
\chapter{Planilhas}
\input{sections/planilhas/introducao.tex}
\input{sections/planilhas/barra.tex}
\input{sections/planilhas/formatacao.tex}
\input{sections/planilhas/formula.tex}
\input{sections/planilhas/graficos.tex}
\input{sections/planilhas/tabelas.tex}
\input{sections/planilhas/compartilhamento.tex}
\input{sections/planilhas/dicas.tex}
%
\chapter{Apresentações}
\input{sections/slides/introducao.tex}
\input{sections/slides/arquivo.tex}
\input{sections/slides/editar.tex}
\input{sections/slides/ver.tex}
\input{sections/slides/inserir.tex}
\input{sections/slides/formatar.tex}
\input{sections/slides/slide.tex}
\input{sections/slides/organizar.tex}
\input{sections/slides/ferramentas.tex}
\input{sections/slides/extensao.tex}
\input{sections/slides/ajuda.tex}
\input{sections/slides/utilizar_links.tex}
\input{sections/slides/colaboracao_e_compartilhamento.tex}
\input{sections/slides/aplicar_temas.tex}
\input{sections/slides/dicas_e_boas_praticas.tex}
%
%
\chapter{Glossario}
\input{sections/extras/glossario.tex}
%
\chapter{Considerações Finais e Agradecimentos}
\input{sections/extras/agradecimentos.tex}

\vfill

\printbibliography[heading=bibnumbered,title={Bibliografia}]

\end{document}
